# Email Agent

Субагент для работы с почтовыми ящиками пользователей.

## Функционал

- **Чтение писем**: получение списка писем, чтение содержимого
- **Фильтрация**: (в настоящее время не настроена)
- **Отправка**: отправка писем через SMTP
- **Управление**: управление ящиками, просмотр папок, проверка подключения

## Настройка

### 1. Настройка секретов

Email Agent использует систему секретов проекта через `state["secrets"]`. 

Для настройки почтового ящика добавьте секреты в следующем формате:

```
email_account@example.com_password = "пароль"
email_account@example.com_imap_host = "imap.example.com"
email_account@example.com_smtp_host = "smtp.example.com"
email_account@example.com_imap_port = "993"
email_account@example.com_smtp_port = "587"
```

Или используйте общие настройки:

```
email_password = "пароль"
imap_host = "imap.example.com"
smtp_host = "smtp.example.com"
```

### 2. Примеры использования

#### Чтение писем
```
"прочитать письма"
"показать непрочитанные письма"
"письма в папке Spam"
"показать все письма"
```

#### Фильтрация
```
"отфильтровать письма"
"проверить спам"
"настройки фильтрации"
```

#### Отправка
```
"отправить письмо к example@mail.com тема: 'Привет' текст: 'Это тестовое письмо'"
```

#### Управление
```
"список ящиков"
"папки"
"проверить подключение"
```

## Структура

```
email_agent/
├── __init__.py
├── config.py              # Конфигурация и состояние
├── graph.py               # Основной граф LangGraph
├── nodes/
│   ├── read.py            # Чтение писем
│   ├── filter.py          # Фильтрация писем
│   ├── send.py            # Отправка писем
│   └── manage.py          # Управление ящиками
└── utils/
    ├── imap_client.py     # Клиент для работы с IMAP
    ├── smtp_client.py     # Клиент для работы с SMTP
    ├── email_parser.py    # Парсинг писем
    └── storage.py         # Хранение конфигураций
```

## Основано на

Код основан на проекте PostFilter (`d:\Python\PostFilter\`), который предоставляет базовую функциональность фильтрации почты через IMAP.

